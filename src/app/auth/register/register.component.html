<div class="auth-container bg-gradient-login">
    <!-- Background Pattern -->
    <div class="ramadan-pattern"></div>

    <!-- Register Card -->
    <div class="auth-card animate-fade-in-up">
        <!-- Header Section -->
        <header class="text-center mb-xl flex flex-col items-center">
            <div class="auth-logo gradient-primary shadow-glow mx-auto">
                <span class="material-symbols-outlined text-4xl text-primary" aria-hidden="true">sports_soccer</span>
            </div>
            <h1 class="auth-title">بطولة رمضان</h1>
            <p class="text-secondary text-base">إنشاء حساب جديد للمشاركة في البطولة</p>
        </header>

        <!-- Step 1: Account Type Selection -->
        <div *ngIf="currentStep === 1" class="selection-container">
            <h2 class="text-xl font-bold mb-6 text-center">اختر نوع الحساب</h2>
            <p class="selection-subtitle text-center">يرجى تحديد الدور الذي ستقوم به في بطولة رمضان. سيساعدنا هذا في
                تخصيص تجربتك بشكل أفضل.</p>

            <div class="cards-grid-selection">
                <!-- Referee Card -->
                <div class="role-card" [class.selected]="form.role === UserRole.REFEREE"
                    (click)="form.role = UserRole.REFEREE" role="button" aria-label="تسجيل كحكم">
                    <div class="role-card-icon">
                        <span class="material-symbols-outlined" aria-hidden="true">sports_whistle</span>
                    </div>
                    <div class="role-card-content">
                        <h3 class="role-card-title">حكم</h3>
                        <p class="role-card-desc">إدارة المباريات، تسجيل النتائج، وضمان اللعب النظيف وتطبيق قوانين
                            البطولة بدقة واحترافية.</p>
                    </div>
                </div>

                <!-- Player Card -->
                <div class="role-card" [class.selected]="form.role === UserRole.PLAYER"
                    (click)="form.role = UserRole.PLAYER" role="button" aria-label="تسجيل كلاعب">
                    <div class="role-card-icon">
                        <span class="material-symbols-outlined">groups</span>
                    </div>
                    <div class="role-card-content">
                        <h3 class="role-card-title">لاعب</h3>
                        <p class="role-card-desc">انضم للبطولة كلاعب، شارك في فريق أو قم بإنشاء فريقك الخاص لتصبح قائداً
                            وأدر تشكيلتك بكل سهولة.</p>
                    </div>
                </div>
            </div>

            <div class="flex justify-center mt-xl">
                <app-button variant="primary" size="xl" (onClick)="currentStep = 2" icon="arrow_back" iconPos="right"
                    [fullWidth]="true">
                    متابعة
                </app-button>
            </div>

            <div class="text-center mt-6">
                <p class="text-secondary text-sm">
                    لديك حساب بالفعل؟
                    <a routerLink="/auth/login" class="text-gold font-bold hover:underline ml-1">تسجيل الدخول</a>
                </p>
            </div>
        </div>

        <!-- Step 2: Detailed Registration Form -->
        <div *ngIf="currentStep === 2" class="form-container-inner animate-slide-in-left">
            <div class="form-header-inner text-center">
                <div class="avatar avatar-lg gradient-primary mx-auto mb-4 rounded-2xl flex-center"
                    style="width: 56px; height: 56px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1);">
                    <span class="material-symbols-outlined text-xl text-primary">person_add</span>
                </div>
                <h2 class="form-step-title">بيانات ال{{ form.role === UserRole.REFEREE ? 'حكم' : 'لاعب' }}</h2>
                <p class="form-step-subtitle">أدخل بياناتك الشخصية لإتمام التسجيل في البطولة</p>
            </div>

            <form (ngSubmit)="onSubmit()" #registerForm="ngForm">
                <div class="form-grid">
                    <!-- Full Name -->
                    <div class="form-group grid-col-span-2">
                        <label class="form-label">الاسم رباعي</label>
                        <input type="text" name="fullName" [(ngModel)]="form.fullName" required class="form-input"
                            placeholder="أدخل اسمك بالكامل كما في البطاقة">
                    </div>

                    <!-- Email -->
                    <div class="form-group">
                        <label class="form-label">البريد الإلكتروني</label>
                        <input type="email" name="email" [(ngModel)]="form.email" required class="form-input"
                            placeholder="example@mail.com">
                    </div>

                    <!-- Phone -->
                    <div class="form-group">
                        <label class="form-label">رقم الهاتف</label>
                        <input type="tel" name="phone" [(ngModel)]="form.phone" required class="form-input"
                            placeholder="05xxxxxxxx">
                    </div>

                    <!-- Age -->
                    <div class="form-group">
                        <label class="form-label">العمر</label>
                        <input type="number" name="age" [(ngModel)]="form.age" required class="form-input"
                            placeholder="سنوات">
                    </div>

                    <!-- National ID -->
                    <div class="form-group">
                        <label class="form-label">الرقم القومي</label>
                        <input type="text" name="nationalId" [(ngModel)]="form.nationalId" required class="form-input"
                            placeholder="14 رقم">
                    </div>

                    <!-- Governorate -->
                    <div class="form-group">
                        <label class="form-label">المحافظة</label>
                        <app-select name="governorate" [(ngModel)]="form.governorate" [options]="governorateOptions"
                            placeholder="اختر المحافظة" (change)="onGovChange($event)">
                        </app-select>
                    </div>

                    <!-- City -->
                    <div class="form-group">
                        <label class="form-label">المدينة</label>
                        <app-select name="city" [(ngModel)]="form.city" [options]="cityOptions"
                            [disabled]="!form.governorate" placeholder="اختر المدينة" (change)="onCityChange($event)">
                        </app-select>
                    </div>

                    <!-- Neighborhood -->
                    <div class="form-group">
                        <label class="form-label">الحي / المنطقة</label>
                        <app-select name="neighborhood" [(ngModel)]="form.neighborhood" [options]="neighborhoodOptions"
                            [disabled]="!form.city" placeholder="اختر الحي">
                        </app-select>
                    </div>

                    <!-- Password -->
                    <div class="form-group">
                        <label class="form-label">كلمة المرور</label>
                        <input type="password" name="password" [(ngModel)]="form.password" required class="form-input"
                            placeholder="••••••••">
                    </div>

                    <!-- Confirm Password -->
                    <div class="form-group">
                        <label class="form-label">تأكيد كلمة المرور</label>
                        <input type="password" name="confirmPassword" [(ngModel)]="form.confirmPassword" required
                            class="form-input" placeholder="••••••••">
                    </div>
                </div>

                <!-- ID Photos -->
                <div class="file-upload-grid mb-6">
                    <div class="file-upload-box" [class.has-file]="form.idFront" (click)="frontInput.click()">
                        <input type="file" #frontInput hidden (change)="onFileChange($event, 'idFront')"
                            accept="image/*">
                        <span class="material-symbols-outlined file-upload-icon">{{ form.idFront ? 'check_circle' :
                            'badge' }}</span>
                        <p class="file-upload-text">{{ form.idFront ? 'تم رفع الوجه الأمامي' : 'صورة الوجه الأمامي' }}
                        </p>
                    </div>

                    <div class="file-upload-box" [class.has-file]="form.idBack" (click)="backInput.click()">
                        <input type="file" #backInput hidden (change)="onFileChange($event, 'idBack')" accept="image/*">
                        <span class="material-symbols-outlined file-upload-icon">{{ form.idBack ? 'check_circle' :
                            'contact_page' }}</span>
                        <p class="file-upload-text">{{ form.idBack ? 'تم رفع الوجه الخلفي' : 'صورة الوجه الخلفي' }}</p>
                    </div>
                </div>


                <app-button type="submit" variant="primary" size="xl" [fullWidth]="true" [isLoading]="isLoading"
                    [disabled]="isLoading || !registerForm.valid">
                    إرسال طلب التسجيل
                </app-button>

                <div class="text-center mt-4">
                    <app-button variant="ghost" (onClick)="currentStep = 1">
                        العودة لاختيار الدور
                    </app-button>
                </div>
            </form>
        </div>
    </div>

    <!-- Footer -->
    <footer class="auth-footer">
        <p class="text-muted text-xs m-0">© 2024 دوري رمضان لكرة القدم. جميع الحقوق محفوظة.</p>
    </footer>
</div>