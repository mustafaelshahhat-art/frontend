<!-- Filters Template -->
<ng-template #filtersTemplate>
    <div class="flex flex-col gap-2">
        <app-filter [items]="filters" [activeValue]="currentFilter()" (filterChange)="setFilter($event)" />
        <app-filter [items]="severityFilters" [activeValue]="currentSeverityFilter()" (filterChange)="setSeverityFilter($event)" />
    </div>
</ng-template>

<!-- Main Content -->
<div class="flex-col gap-md">
    <!-- Loading State -->
    @if (isLoading()) {
    <app-inline-loading message="جاري تحميل السجلات..." />
    }

    <!-- Empty State (No Logs at all) -->
    @if (!isLoading() && activities().length === 0) {
    <app-empty-state icon="search_off" title="لا توجد نتائج" description="لا توجد سجلات تطابق الفلتر المختار" />
    }

    <!-- Table -->
    @if (!isLoading() && activities().length > 0) {
    <div class="card p-0 overflow-hidden">
        <app-table [data]="activities()" [columns]="columns" [loading]="isLoading()" />

        <!-- Pagination -->
        <app-pagination
            [pageNumber]="currentPage"
            [totalPages]="totalPages"
            [hasPreviousPage]="hasPreviousPage"
            [hasNextPage]="hasNextPage"
            [summary]="paginationSummary"
            (pageChange)="loadPage($event)" />
    </div>
    }
</div>

<!-- User Template -->
<ng-template #userInfo let-row="row">
    <div class="flex items-center gap-3">
        <div class="w-8 h-8 rounded-full bg-surface-dark flex items-center justify-center">
            <span class="text-primary font-bold text-sm">{{ (row.userName || 'U').charAt(0) }}</span>
        </div>
        <span class="text-primary font-bold text-sm">{{ row.userName || 'نظام' }}</span>
    </div>
</ng-template>

<!-- Action Template -->
<ng-template #actionInfo let-row="row">
    <span class="text-secondary text-sm">{{ row.action || row.message }}</span>
</ng-template>

<!-- Time Template -->
<ng-template #timeInfo let-row="row">
    <div class="flex flex-col">
        <span class="text-primary text-xs font-bold">{{ row.timestamp | timeAgo }}</span>
        <span class="text-muted text-[10px] font-mono">{{ row.timestamp | date:'yyyy-MM-dd HH:mm:ss' }}</span>
    </div>
</ng-template>

<!-- Severity Template -->
<ng-template #severityInfo let-row="row">
    <app-badge [type]="getSeverityBadge(row.severity).type">
        {{ getSeverityBadge(row.severity).label }}
    </app-badge>
</ng-template>

<!-- Status Template -->
<ng-template #statusInfo let-row="row">
    <app-badge [type]="getBadgeType(row.type)">
        {{ row.type }}
    </app-badge>
</ng-template>