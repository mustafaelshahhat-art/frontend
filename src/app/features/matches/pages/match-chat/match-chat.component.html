<div class="chat-page">
    <app-chat-box *ngIf="!isLoading && isAuthorized && match" [title]="match.homeTeamName + ' vs ' + match.awayTeamName"
        [match]="match" [messages]="mappedMessages" [currentUserId]="currentUser?.id || ''"
        [participants]="participants" [referee]="getReferee() || null" [readOnly]="isMatchFinished" (back)="goBack()"
        (send)="onSendMessage($event)">
    </app-chat-box>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="flex-center p-xl">
        <div class="spinner-lg"></div>
    </div>

    <!-- Unauthorized State -->
    <div *ngIf="!isLoading && !isAuthorized" class="chat-unauthorized">
        <h2>غير مصرح لك بالدخول</h2>
        <app-button (onClick)="goBack()">العودة</app-button>
    </div>
</div>