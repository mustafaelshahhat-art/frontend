<!-- Filter Section -->
<ng-template #filtersTemplate>
    <app-filter [items]="filters" [activeValue]="currentFilter()" (change)="setFilter($event)"></app-filter>
</ng-template>

<!-- Main Content -->
<div class="flex-col gap-md">
    <!-- Loading State -->
    <app-inline-loading *ngIf="isLoading()" message="جاري تحميل الفرق..."></app-inline-loading>

    <!-- Empty State -->
    <app-empty-state *ngIf="!isLoading() && filteredTeams().length === 0" icon="groups" title="لا توجد فرق"
        description="لا توجد فرق في هذا التصنيف حالياً">
    </app-empty-state>

    <!-- Desktop Table View -->
    <div *ngIf="!isLoading() && filteredTeams().length > 0" class="table-wrapper hide-on-mobile">
        <app-table [data]="filteredTeams()" [columns]="columns" [loading]="isLoading()"
            emptyMessage="لا توجد فرق في هذا التصنيف حالياً">
        </app-table>
    </div>

    <!-- Mobile Cards View -->
    <div *ngIf="!isLoading() && filteredTeams().length > 0" class="mobile-teams-list show-only-mobile">
        <div *ngFor="let team of filteredTeams()" class="card team-mobile-card" [class.is-disabled]="!team.isActive">
            <div class="card-header-flex">
                <div class="flex items-center gap-3">
                    <app-smart-image [src]="team.logo" type="team" size="sm" [initials]="team.name.charAt(0)">
                    </app-smart-image>
                    <div class="flex-col">
                        <span class="text-primary font-bold">{{ team.name }}</span>
                        <span class="text-muted text-xs">{{ team.city }}</span>
                    </div>
                </div>
                <ng-container *ngIf="getTeamStatusConfig(team.isActive) as status">
                    <app-badge [type]="status.variant">
                        {{ status.label }}
                    </app-badge>
                </ng-container>
            </div>

            <div class="card-body-details">
                <div class="detail-row">
                    <span class="label">الكابتن</span>
                    <span class="value">{{ team.captainName }}</span>
                </div>
                <div class="detail-row">
                    <span class="label">اللاعبين</span>
                    <span class="value text-gold font-bold">{{ team.playerCount }} / {{ team.maxPlayers }}</span>
                </div>
            </div>

            <div class="card-footer-actions">
                <app-button (click)="viewTeam(team)" variant="ghost" size="md" icon="visibility" class="text-info"
                    title="عرض التفاصيل"></app-button>
                <div class="flex-1"></div>
                <div class="flex items-center gap-2">
                    <app-button (click)="requestToggleStatus(team)" variant="ghost" size="md"
                        [icon]="team.isActive ? 'block' : 'check_circle'" [class.text-danger]="team.isActive"
                        [class.text-success]="!team.isActive" [title]="team.isActive ? 'تعطيل' : 'تفعيل'">
                    </app-button>
                    <app-button (click)="requestDelete(team)" variant="ghost" size="md" icon="delete"
                        class="text-danger" title="حذف">
                    </app-button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Team Info Template -->
<ng-template #teamInfo let-row="row">
    <div class="flex items-center gap-3">
        <app-smart-image [src]="row.logo" type="team" size="sm" [initials]="row.name.charAt(0)">
        </app-smart-image>
        <div class="flex-col">
            <span class="text-primary font-bold text-sm">{{ row.name }}</span>
            <span class="text-muted text-xs">{{ row.city }}</span>
        </div>
    </div>
</ng-template>

<!-- Captain Template -->
<ng-template #captainInfo let-row="row">
    <span class="text-primary text-sm">{{ row.captainName }}</span>
</ng-template>

<!-- Players Template -->
<ng-template #playersInfo let-row="row">
    <span class="text-gold font-bold">{{ row.playerCount }} / {{ row.maxPlayers }}</span>
</ng-template>

<!-- Status Template -->
<ng-template #adminStatusInfo let-row="row">
    <ng-container *ngIf="getTeamStatusConfig(row.isActive) as status">
        <app-badge [type]="status.variant" [dot]="true" [dotType]="row.isActive ? 'active' : 'error'">
            {{ status.label }}
        </app-badge>
    </ng-container>
</ng-template>

<!-- Actions Template -->
<ng-template #actionsInfo let-row="row">
    <div class="flex items-center justify-end gap-2">
        <app-button (click)="viewTeam(row)" variant="ghost" size="sm" icon="visibility" class="text-info"
            title="عرض التفاصيل">
        </app-button>
        <app-button (click)="requestDelete(row)" variant="ghost" size="sm" icon="delete" class="text-danger"
            title="حذف">
        </app-button>
        <app-button (click)="requestToggleStatus(row)" variant="ghost" size="sm"
            [icon]="row.isActive ? 'block' : 'check_circle'" [class.text-danger]="row.isActive"
            [class.text-success]="!row.isActive" [title]="row.isActive ? 'تعطيل' : 'تفعيل'">
        </app-button>
    </div>
</ng-template>