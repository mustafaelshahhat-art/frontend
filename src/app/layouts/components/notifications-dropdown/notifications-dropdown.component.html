@if (isOpen) {
<div class="notifications-dropdown" [class.notifications-dropdown-mobile]="isMobile" role="listbox"
  aria-label="قائمة التنبيهات">
  <div class="notifications-header">
    <h3 class="notifications-title">التنبيهات</h3>
    <span class="badge badge-primary">{{ unreadCount }} جديدة</span>
  </div>
  <div class="notifications-list">
    <!-- Empty State -->
    @if (notifications.length === 0) {
    <div class="notification-empty">
      <div class="notification-empty-icon">
        <app-icon name="notifications_off" class=" icon-sm"></app-icon>
      </div>
      <div class="text-center">
        <p class="text-primary font-bold mb-2">لا توجد تنبيهات</p>
        <p class="text-muted text-sm">سنتصل بك عند وجود تحديثات جديدة</p>
      </div>
    </div>
    }
    @for (n of notifications; track n.id) {
    <div class="notification-item" (click)="handleViewNotification(n)" (keydown.enter)="handleViewNotification(n)"
      (keydown.space)="$event.preventDefault(); handleViewNotification(n)" tabindex="0" role="option"
      [aria-selected]="!n.isRead">
      <div class="notification-icon" [class]="'notification-icon-' + n.type">
        <app-icon [name]=" getTypeIcon(n.type) " class=" icon-sm"></app-icon>
      </div>
      <div class="notification-content">
        <div class="flex-between mb-1">
          <p class="notification-title">{{ n.title }}</p>
          <div class="flex items-center gap-2">
            <span class="notification-time">{{ n.createdAt | timeAgo }}</span>
            @if (!n.isRead) {
            <div class="notification-unread-dot"></div>
            }
          </div>
        </div>
        <p class="notification-message truncate">{{ n.message }}</p>
      </div>
    </div>
    }
  </div>
  <div class="notifications-footer">
    <button type="button" (click)="handleViewAll()" class="notifications-view-all">عرض كافة التنبيهات</button>
  </div>
</div>
}