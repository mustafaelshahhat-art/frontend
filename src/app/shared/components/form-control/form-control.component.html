<div class="form-group" [class.has-error]="errorMessage" [class.has-icon-left]="!!iconLeft && !isPasswordField"
    [class.has-icon-right]="!!iconRight || isPasswordField" [class.disabled]="disabled">

    @if (label) {
    <label [for]="id" class="form-label">{{ label }}</label>
    }

    <div class="input-wrapper">
        @if (iconLeft && !isPasswordField) {
        <span class="material-symbols-outlined form-icon" [class.icon-left]="!isPasswordField"
            [class.icon-right]="isPasswordField" [class.clickable]="iconLeftClick.observed"
            (click)="iconLeftClick.emit()" (keyup.enter)="iconLeftClick.emit()" tabindex="0">
            {{ iconLeft }}
        </span>
        }

        @if (type === 'textarea') {
        <textarea [id]="id" [rows]="rows" [placeholder]="placeholder" [value]="value" [disabled]="disabled"
            (input)="onInput($event)" (blur)="onBlur()" class="form-input textarea-control">
            </textarea>
        } @else if (type === 'select') {
            <select [id]="id" [value]="value" [disabled]="disabled" (change)="onInput($event)" (blur)="onBlur()" class="form-input form-select">
                @for (option of options; track option.value) {
                    <option [value]="option.value">{{ option.label }}</option>
                }
            </select>
        } @else {
        <input [id]="id" [type]="inputType" [placeholder]="placeholder" [value]="value" [disabled]="disabled"
            [attr.min]="min" (input)="onInput($event)" (blur)="onBlur()" class="form-input"
            [attr.autocomplete]="isPasswordField ? 'current-password' : null">
        }

        <!-- Password visibility toggle (auto-shown for password fields) -->
        @if (isPasswordField) {
        <button type="button" class="password-toggle form-icon icon-left clickable" (click)="togglePasswordVisibility()"
            [attr.aria-label]="passwordVisible ? 'إخفاء كلمة المرور' : 'إظهار كلمة المرور'"
            [attr.aria-pressed]="passwordVisible" tabindex="0" [class.left-padding]="!!iconLeft">
            <span class="material-symbols-outlined">{{ passwordToggleIcon }}</span>
        </button>
        }

        <!-- Custom right icon (only if not a password field) -->
        @if (iconRight && !isPasswordField) {
        <span class="material-symbols-outlined form-icon icon-right" [class.clickable]="iconRightClick.observed"
            (click)="iconRightClick.emit()" (keyup.enter)="iconRightClick.emit()" tabindex="0">
            {{ iconRight }}
        </span>
        }
    </div>

    @if (errorMessage) {
    <div class="form-error animate-fade-in">
        <span class="material-symbols-outlined error-icon">error</span>
        {{ errorMessage }}
    </div>
    } @else if (hint) {
    <div class="form-hint">
        {{ hint }}
    </div>
    }
</div>